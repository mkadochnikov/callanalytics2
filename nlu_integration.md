# üöÄ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è NLU –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∑–≤–æ–Ω–∫–æ–≤ —Å–∞–Ω–∞—Ç–æ—Ä–∏—è

## üìã –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∑–∞–º–µ–Ω—ã/–¥–æ–±–∞–≤–ª–µ–Ω–∏—è

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã (–¥–æ–±–∞–≤–∏—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç):
1. **advanced_nlu.py** - –ú–æ–¥—É–ª—å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–≥–æ NLU –∞–Ω–∞–ª–∏–∑–∞
2. **test_nlu.py** - –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
3. **install_nlu.sh** - –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–¥–ª—è Linux/Mac)

### –§–∞–π–ª—ã –¥–ª—è –∑–∞–º–µ–Ω—ã:
1. **requirements.txt** - –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
2. **config.py** - –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
3. **ai_analyzer.py** - –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä

### –§–∞–π–ª—ã –ë–ï–ó –∏–∑–º–µ–Ω–µ–Ω–∏–π (–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å):
- main.py
- main_analyzer.py
- bitrix_api.py
- audio_processor.py
- data_manager.py
- manager_analytics.py

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### Windows:
```powershell
# 1. –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
.\venv\Scripts\activate

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install --upgrade pip
pip install -r requirements.txt

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ NLU –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
pip install natasha>=1.6.0 razdel>=0.5.0 navec>=0.10.0 slovnet>=0.6.0
pip install yargy>=0.16.0 ipymarkup>=0.9.0 pymorphy2>=0.9.1
pip install pymorphy2-dicts-ru>=2.4.417127.4579844

# 4. –ó–∞–≥—Ä—É–∑–∏—Ç–µ NLTK –¥–∞–Ω–Ω—ã–µ
python -c "import nltk; nltk.download('punkt'); nltk.download('stopwords')"
```

### Linux/Mac:
```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x install_nlu.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É
./install_nlu.sh
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ä–∞–±–æ—Ç—É NLU:

```bash
python test_nlu.py
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚úÖ NLU –º–æ–¥—É–ª—å –∞–∫—Ç–∏–≤–µ–Ω
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π

## üìù –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è):
```python
from ai_analyzer import LocalAIAnalyzer

analyzer = LocalAIAnalyzer()

# –ê–Ω–∞–ª–∏–∑ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏
result = analyzer.classify_topic(transcript)
objection = analyzer.find_objection_reason(transcript)
```

### –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:
```python
# –ü–æ–ª–Ω—ã–π NLU –∞–Ω–∞–ª–∏–∑
full_analysis = analyzer.analyze_full_dialogue(transcript)

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:
# - topic: —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ç–µ–º–∞
# - objections: —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
# - entities: –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (–¥–∞—Ç—ã, —Å—É–º–º—ã, –∏–º–µ–Ω–∞)
# - business_data: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã–µ
# - call_result: —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–≤–æ–Ω–∫–∞ (—É—Å–ø–µ—Ö/–æ—Ç–∫–∞–∑/followup)
# - sales_stage: —ç—Ç–∞–ø –ø—Ä–æ–¥–∞–∂–∏
# - emotional_context: —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç

print(f"–¢–µ–º–∞: {full_analysis['topic']}")
print(f"–≠—Ç–∞–ø –ø—Ä–æ–¥–∞–∂–∏: {full_analysis['sales_stage']}")
print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {full_analysis['call_result']['result']}")

# –ò–∑–≤–ª–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
business = full_analysis['business_data']
print(f"–î–∞—Ç—ã –∑–∞–µ–∑–¥–∞: {business['dates']['check_in']}")
print(f"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Å—Ç–µ–π: {business['guests']['total']}")
print(f"–¶–µ–Ω—ã: {business['financial']['quoted_prices']}")
```

## üéØ –ß—Ç–æ —É–ª—É—á—à–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 1. –¢–æ—á–Ω–æ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–º (+40%)
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∏–∞–ª–æ–≥–∞
- –£—á–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ–ø–ª–∏–∫
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ç–µ–º—ã —Å–∞–Ω–∞—Ç–æ—Ä–∏—è

### 2. –í—ã—è–≤–ª–µ–Ω–∏–µ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π (+60%)
- 12 —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è —Å–∞–Ω–∞—Ç–æ—Ä–∏—è
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ

### 3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã—Ö (–Ω–æ–≤–æ–µ)
- –î–∞—Ç—ã –∑–∞–µ–∑–¥–∞/–≤—ã–µ–∑–¥–∞
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ—Å—Ç–µ–π (–≤–∑—Ä–æ—Å–ª—ã–µ/–¥–µ—Ç–∏)
- –¢–∏–ø –Ω–æ–º–µ—Ä–∞ –∏ –ø–∏—Ç–∞–Ω–∏—è
- –£–ø–æ–º—è–Ω—É—Ç—ã–µ —Ü–µ–Ω—ã –∏ —Å–∫–∏–¥–∫–∏
- –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### 4. –ê–Ω–∞–ª–∏–∑ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –∑–≤–æ–Ω–∫–∞ (–Ω–æ–≤–æ–µ)
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (—É—Å–ø–µ—Ö/–æ—Ç–∫–∞–∑/—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–∞–º
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —ç—Ç–∞–ø–∞ –ø—Ä–æ–¥–∞–∂–∏

## üö® –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –û—à–∏–±–∫–∞ "ModuleNotFoundError: No module named 'natasha'"
```bash
pip install natasha razdel navec slovnet yargy ipymarkup
```

### –û—à–∏–±–∫–∞ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–µ–π
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ–∑ DeepPavlov (–æ–Ω –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω)
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±–∞–∑–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

### NLU –º–æ–¥—É–ª—å –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É:
```python
python -c "from natasha import Doc, Segmenter; print('OK')"
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | RAM | –°–∫–æ—Ä–æ—Å—Ç—å | –¢–æ—á–Ω–æ—Å—Ç—å |
|-----------|-----|----------|----------|
| –ë–∞–∑–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑ | 2GB | 100 –∑–≤–æ–Ω–∫–æ–≤/–º–∏–Ω | 70% |
| + Natasha NLU | 3GB | 80 –∑–≤–æ–Ω–∫–æ–≤/–º–∏–Ω | 85% |
| + DeepPavlov | 6GB | 40 –∑–≤–æ–Ω–∫–æ–≤/–º–∏–Ω | 92% |

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
streamlit run main.py
```

–í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
‚úÖ NLU –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ –ú–æ–¥–µ–ª—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
‚úÖ Natasha –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ test_nlu.py –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã –∑–∞–º–µ–Ω–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
4. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±–∞–∑–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –µ—Å–ª–∏ NLU –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω